<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/AndroidManifest.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/AndroidManifest.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;application&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:theme=&quot;@style/Theme.PAMProject&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&#10;            android:label=&quot;@string/app_name&quot;&#10;            android:theme=&quot;@style/Theme.PAMProject&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#13;&#10;&#13;&#10;    &lt;application&#13;&#10;        android:allowBackup=&quot;true&quot;&#13;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#13;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#13;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#13;&#10;        android:label=&quot;@string/app_name&quot;&#13;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#13;&#10;        android:supportsRtl=&quot;true&quot;&#13;&#10;        android:theme=&quot;@style/Theme.PAMProject&quot;&gt;&#13;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&#10;            android:label=&quot;@string/app_name&quot;&#10;            android:theme=&quot;@style/Theme.PAMProject&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;        &#10;        &lt;provider&#10;            android:name=&quot;androidx.core.content.FileProvider&quot;&#10;            android:authorities=&quot;${applicationId}.fileprovider&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:grantUriPermissions=&quot;true&quot;&gt;&#10;            &lt;meta-data&#10;                android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot;&#10;                android:resource=&quot;@xml/file_paths&quot; /&gt;&#10;        &lt;/provider&gt;&#10;    &lt;/application&gt;&#13;&#10;&#13;&#10;&lt;/manifest&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/pamproject/ui/screen/WorkoutSessionScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/pamproject/ui/screen/WorkoutSessionScreen.kt" />
              <option name="originalContent" value="package com.example.pamproject.ui.screen&#10;&#10;import androidx.activity.compose.rememberLauncherForActivityResult&#10;import androidx.activity.result.PickVisualMediaRequest&#10;import androidx.activity.result.contract.ActivityResultContracts&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.border&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.AddAPhoto&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Bolt&#10;import androidx.compose.material.icons.filled.PhotoLibrary&#10;import androidx.compose.material3.AlertDialog&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.ButtonDefaults&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.SnackbarHost&#10;import androidx.compose.material3.SnackbarHostState&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.shadow&#10;import androidx.compose.ui.graphics.Brush&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import coil.compose.rememberAsyncImagePainter&#10;import com.example.pamproject.model.Workout&#10;import com.example.pamproject.model.WorkoutLog&#10;import com.example.pamproject.viewmodel.WorkoutViewModel&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun WorkoutSessionScreen(&#10;    workout: Workout?,&#10;    timerState: WorkoutViewModel.TimerState,&#10;    onStart: () -&gt; Unit,&#10;    onPause: () -&gt; Unit,&#10;    onResume: () -&gt; Unit,&#10;    onFinish: (String?) -&gt; WorkoutLog?,&#10;    onBack: () -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;    var showFinishDialog by remember { mutableStateOf(false) }&#10;    var showPhotoSection by remember { mutableStateOf(false) }&#10;    var selectedImageUri by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    val context = LocalContext.current&#10;&#10;    val galleryLauncher = rememberLauncherForActivityResult(&#10;        contract = ActivityResultContracts.PickVisualMedia()&#10;    ) { uri -&gt;&#10;        uri?.let {&#10;            // Persist read permission for future use&#10;            try {&#10;                context.contentResolver.takePersistableUriPermission(&#10;                    it,&#10;                    android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION&#10;                )&#10;            } catch (_: Exception) {&#10;                // ignore if not persistable&#10;            }&#10;            selectedImageUri = it.toString()&#10;        }&#10;    }&#10;&#10;    val finishSession: () -&gt; Unit = {&#10;        showPhotoSection = true&#10;        showFinishDialog = false&#10;    }&#10;&#10;    LaunchedEffect(workout?.id) {&#10;        if (workout == null) onBack()&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(text = workout?.name ?: &quot;Workout&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onBack) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Kembali&quot;&#10;                        )&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.background,&#10;                    titleContentColor = MaterialTheme.colorScheme.onBackground,&#10;                    navigationIconContentColor = MaterialTheme.colorScheme.onBackground&#10;                )&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(hostState = snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        Column(&#10;            modifier = modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;                .background(MaterialTheme.colorScheme.background)&#10;                .padding(20.dp),&#10;            verticalArrangement = Arrangement.spacedBy(24.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            TimerDisplay(workout, timerState)&#10;&#10;            if (!showPhotoSection) {&#10;                ControlButtons(&#10;                    isRunning = timerState.isRunning,&#10;                    isPaused = timerState.isPaused,&#10;                    onStart = onStart,&#10;                    onPause = onPause,&#10;                    onResume = onResume,&#10;                    onFinish = { showFinishDialog = true }&#10;                )&#10;            } else {&#10;                // Post-session photo &amp; save section&#10;                Column(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Tambahkan foto hasil workout (opsional)&quot;,&#10;                        style = MaterialTheme.typography.titleMedium,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.SemiBold&#10;                    )&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;                    ) {&#10;                        Button(&#10;                            onClick = {&#10;                                galleryLauncher.launch(&#10;                                    PickVisualMediaRequest(ActivityResultContracts.PickVisualMedia.ImageOnly)&#10;                                )&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.primary,&#10;                                contentColor = MaterialTheme.colorScheme.onPrimary&#10;                            )&#10;                        ) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.PhotoLibrary,&#10;                                contentDescription = null&#10;                            )&#10;                            Spacer(modifier = Modifier.width(8.dp))&#10;                            Text(&quot;Dari Galeri&quot;)&#10;                        }&#10;&#10;                        // Kamera bisa ditambahkan kemudian jika diinginkan&#10;                    }&#10;&#10;                    if (selectedImageUri != null) {&#10;                        Spacer(modifier = Modifier.height(12.dp))&#10;                        Text(&#10;                            text = &quot;Preview Foto&quot;,&#10;                            style = MaterialTheme.typography.bodyMedium,&#10;                            fontWeight = FontWeight.Medium&#10;                        )&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(180.dp)&#10;                                .background(&#10;                                    color = MaterialTheme.colorScheme.surfaceVariant,&#10;                                    shape = RoundedCornerShape(16.dp)&#10;                                ),&#10;                            contentAlignment = Alignment.Center&#10;                        ) {&#10;                            Image(&#10;                                painter = rememberAsyncImagePainter(selectedImageUri),&#10;                                contentDescription = null,&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentScale = ContentScale.Crop&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;                    ) {&#10;                        Button(&#10;                            onClick = {&#10;                                val result = onFinish(selectedImageUri)&#10;                                result?.let {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&#10;                                            message = &quot;Durasi: ${&quot;%.1f&quot;.format(it.durationMinutes)} menit 路 ${it.calories.toInt()} kcal&quot;&#10;                                        )&#10;                                    }&#10;                                }&#10;                                onBack()&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.primary,&#10;                                contentColor = MaterialTheme.colorScheme.onPrimary&#10;                            )&#10;                        ) {&#10;                            Text(&quot;Simpan &amp; Kembali&quot;)&#10;                        }&#10;&#10;                        Button(&#10;                            onClick = {&#10;                                val result = onFinish(null)&#10;                                result?.let {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&#10;                                            message = &quot;Durasi: ${&quot;%.1f&quot;.format(it.durationMinutes)} menit 路 ${it.calories.toInt()} kcal&quot;&#10;                                        )&#10;                                    }&#10;                                }&#10;                                onBack()&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.secondary,&#10;                                contentColor = MaterialTheme.colorScheme.onSecondary&#10;                            )&#10;                        ) {&#10;                            Text(&quot;Lewati Foto&quot;)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    if (showFinishDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showFinishDialog = false },&#10;            icon = {&#10;                Icon(&#10;                    imageVector = Icons.Default.Bolt,&#10;                    contentDescription = null,&#10;                    tint = MaterialTheme.colorScheme.primary&#10;                )&#10;            },&#10;            title = { Text(text = &quot;Selesaikan sesi?&quot;) },&#10;            text = { Text(text = &quot;Pastikan kamu sudah menyelesaikan workout ini.&quot;) },&#10;            confirmButton = {&#10;                TextButton(onClick = finishSession) {&#10;                    Text(text = &quot;Ya, selesai&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { showFinishDialog = false }) {&#10;                    Text(text = &quot;Batal&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ControlButtons(&#10;    isRunning: Boolean,&#10;    isPaused: Boolean,&#10;    onStart: () -&gt; Unit,&#10;    onPause: () -&gt; Unit,&#10;    onResume: () -&gt; Unit,&#10;    onFinish: () -&gt; Unit&#10;) {&#10;    Column(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        verticalArrangement = Arrangement.spacedBy(14.dp)&#10;    ) {&#10;        Button(&#10;            onClick = { if (isPaused) onResume() else onStart() },&#10;            enabled = !isRunning,&#10;            colors = ButtonDefaults.buttonColors(&#10;                containerColor = MaterialTheme.colorScheme.primary,&#10;                contentColor = MaterialTheme.colorScheme.onPrimary&#10;            ),&#10;            shape = RoundedCornerShape(14.dp),&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(if (isPaused) &quot;Resume&quot; else &quot;Mulai Sekarang&quot;, fontWeight = FontWeight.SemiBold)&#10;        }&#10;&#10;        Row(&#10;            modifier = Modifier.fillMaxWidth(),&#10;            horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;        ) {&#10;            Button(&#10;                onClick = onPause,&#10;                enabled = isRunning,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = MaterialTheme.colorScheme.secondary,&#10;                    contentColor = MaterialTheme.colorScheme.onSecondary&#10;                ),&#10;                shape = RoundedCornerShape(14.dp),&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&quot;Pause&quot;, fontWeight = FontWeight.SemiBold)&#10;            }&#10;&#10;            Button(&#10;                onClick = onFinish,&#10;                enabled = isRunning || isPaused,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = MaterialTheme.colorScheme.tertiary,&#10;                    contentColor = MaterialTheme.colorScheme.onTertiary&#10;                ),&#10;                shape = RoundedCornerShape(14.dp),&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&quot;Selesai&quot;, fontWeight = FontWeight.SemiBold)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun TimerDisplay(workout: Workout?, timerState: WorkoutViewModel.TimerState) {&#10;    Column(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        verticalArrangement = Arrangement.spacedBy(16.dp)&#10;    ) {&#10;        Box(&#10;            modifier = Modifier&#10;                .size(260.dp)&#10;                .shadow(24.dp, CircleShape)&#10;                .border(&#10;                    width = 2.dp,&#10;                    brush = Brush.linearGradient(&#10;                        colors = listOf(&#10;                            MaterialTheme.colorScheme.primary,&#10;                            MaterialTheme.colorScheme.secondary&#10;                        )&#10;                    ),&#10;                    shape = CircleShape&#10;                )&#10;                .background(MaterialTheme.colorScheme.surfaceVariant, CircleShape)&#10;                .padding(28.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Column(&#10;                horizontalAlignment = Alignment.CenterHorizontally,&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(72.dp)&#10;                        .background(MaterialTheme.colorScheme.background, CircleShape),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Bolt,&#10;                        contentDescription = null,&#10;                        tint = MaterialTheme.colorScheme.primary,&#10;                        modifier = Modifier.size(36.dp)&#10;                    )&#10;                }&#10;&#10;                Text(&#10;                    text = formatTime(timerState.elapsedSeconds),&#10;                    style = MaterialTheme.typography.displayMedium,&#10;                    fontWeight = FontWeight.ExtraBold&#10;                )&#10;                Text(&#10;                    text = when {&#10;                        timerState.isRunning -&gt; &quot;Tracking in progress&quot;&#10;                        timerState.isPaused -&gt; &quot;Paused, ready to resume&quot;&#10;                        else -&gt; &quot;Siap mulai sesi&quot;&#10;                    },&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;        }&#10;&#10;        Column(&#10;            horizontalAlignment = Alignment.CenterHorizontally,&#10;            verticalArrangement = Arrangement.spacedBy(6.dp)&#10;        ) {&#10;            Text(&#10;                text = workout?.name ?: &quot;&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                fontWeight = FontWeight.Bold&#10;            )&#10;            Row(horizontalArrangement = Arrangement.spacedBy(12.dp)) {&#10;                StatusPill(text = &quot;MET ${workout?.met ?: &quot;-&quot;}&quot;)&#10;                StatusPill(text = if (timerState.isRunning) &quot;Live&quot; else &quot;Idle&quot;)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun StatusPill(text: String) {&#10;    Box(&#10;        modifier = Modifier&#10;            .background(&#10;                MaterialTheme.colorScheme.background,&#10;                shape = RoundedCornerShape(12.dp)&#10;            )&#10;            .border(&#10;                width = 1.dp,&#10;                brush = Brush.linearGradient(&#10;                    listOf(&#10;                        MaterialTheme.colorScheme.primary,&#10;                        MaterialTheme.colorScheme.secondary&#10;                    )&#10;                ),&#10;                shape = RoundedCornerShape(12.dp)&#10;            )&#10;            .padding(horizontal = 12.dp, vertical = 6.dp)&#10;    ) {&#10;        Text(&#10;            text = text,&#10;            style = MaterialTheme.typography.bodySmall,&#10;            color = MaterialTheme.colorScheme.onSurface&#10;        )&#10;    }&#10;}&#10;&#10;private fun formatTime(seconds: Int): String {&#10;    val minutes = seconds / 60&#10;    val remainingSeconds = seconds % 60&#10;    return String.format(&quot;%02d:%02d&quot;, minutes, remainingSeconds)&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.pamproject.ui.screen&#10;&#10;import android.net.Uri&#10;import androidx.activity.compose.rememberLauncherForActivityResult&#10;import androidx.activity.result.PickVisualMediaRequest&#10;import androidx.activity.result.contract.ActivityResultContracts&#10;import androidx.compose.foundation.Image&#10;import androidx.core.content.FileProvider&#10;import java.io.File&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.border&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.AddAPhoto&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Bolt&#10;import androidx.compose.material.icons.filled.PhotoLibrary&#10;import androidx.compose.material3.AlertDialog&#10;import androidx.compose.material3.Button&#10;import androidx.compose.material3.ButtonDefaults&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.SnackbarHost&#10;import androidx.compose.material3.SnackbarHostState&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TextButton&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.rememberCoroutineScope&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.shadow&#10;import androidx.compose.ui.graphics.Brush&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import coil.compose.rememberAsyncImagePainter&#10;import com.example.pamproject.model.Workout&#10;import com.example.pamproject.model.WorkoutLog&#10;import com.example.pamproject.viewmodel.WorkoutViewModel&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun WorkoutSessionScreen(&#10;    workout: Workout?,&#10;    timerState: WorkoutViewModel.TimerState,&#10;    onStart: () -&gt; Unit,&#10;    onPause: () -&gt; Unit,&#10;    onResume: () -&gt; Unit,&#10;    onFinish: (String?) -&gt; WorkoutLog?,&#10;    onBack: () -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;    var showFinishDialog by remember { mutableStateOf(false) }&#10;    var showPhotoSection by remember { mutableStateOf(false) }&#10;    var selectedImageUri by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var cameraImageUri by remember { mutableStateOf&lt;Uri?&gt;(null) }&#10;&#10;    val context = LocalContext.current&#10;&#10;    // Create temp file for camera&#10;    val createImageFile: () -&gt; File = {&#10;        val timeStamp = System.currentTimeMillis()&#10;        val storageDir = context.cacheDir&#10;        File.createTempFile(&#10;            &quot;WORKOUT_${timeStamp}_&quot;,&#10;            &quot;.jpg&quot;,&#10;            storageDir&#10;        )&#10;    }&#10;&#10;    val cameraLauncher = rememberLauncherForActivityResult(&#10;        contract = ActivityResultContracts.TakePicture()&#10;    ) { success -&gt;&#10;        if (success) {&#10;            cameraImageUri?.let {&#10;                selectedImageUri = it.toString()&#10;            }&#10;        }&#10;    }&#10;&#10;    val galleryLauncher = rememberLauncherForActivityResult(&#10;        contract = ActivityResultContracts.PickVisualMedia()&#10;    ) { uri -&gt;&#10;        uri?.let {&#10;            // Persist read permission for future use&#10;            try {&#10;                context.contentResolver.takePersistableUriPermission(&#10;                    it,&#10;                    android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION&#10;                )&#10;            } catch (_: Exception) {&#10;                // ignore if not persistable&#10;            }&#10;            selectedImageUri = it.toString()&#10;        }&#10;    }&#10;&#10;    val finishSession: () -&gt; Unit = {&#10;        // Pause timer when finishing session&#10;        if (timerState.isRunning) {&#10;            onPause()&#10;        }&#10;        showPhotoSection = true&#10;        showFinishDialog = false&#10;    }&#10;&#10;    LaunchedEffect(workout?.id) {&#10;        if (workout == null) onBack()&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(text = workout?.name ?: &quot;Workout&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onBack) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Kembali&quot;&#10;                        )&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.background,&#10;                    titleContentColor = MaterialTheme.colorScheme.onBackground,&#10;                    navigationIconContentColor = MaterialTheme.colorScheme.onBackground&#10;                )&#10;            )&#10;        },&#10;        snackbarHost = { SnackbarHost(hostState = snackbarHostState) }&#10;    ) { paddingValues -&gt;&#10;        Column(&#10;            modifier = modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;                .background(MaterialTheme.colorScheme.background)&#10;                .padding(20.dp),&#10;            verticalArrangement = Arrangement.spacedBy(24.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            TimerDisplay(workout, timerState)&#10;&#10;            if (!showPhotoSection) {&#10;                ControlButtons(&#10;                    isRunning = timerState.isRunning,&#10;                    isPaused = timerState.isPaused,&#10;                    onStart = onStart,&#10;                    onPause = onPause,&#10;                    onResume = onResume,&#10;                    onFinish = { showFinishDialog = true }&#10;                )&#10;            } else {&#10;                // Post-session photo &amp; save section&#10;                Column(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Tambahkan foto hasil workout (opsional)&quot;,&#10;                        style = MaterialTheme.typography.titleMedium,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.SemiBold&#10;                    )&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;                    ) {&#10;                        Button(&#10;                            onClick = {&#10;                                val photoFile = createImageFile()&#10;                                val photoUri = FileProvider.getUriForFile(&#10;                                    context,&#10;                                    &quot;${context.packageName}.fileprovider&quot;,&#10;                                    photoFile&#10;                                )&#10;                                cameraImageUri = photoUri&#10;                                cameraLauncher.launch(photoUri)&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.primary,&#10;                                contentColor = MaterialTheme.colorScheme.onPrimary&#10;                            )&#10;                        ) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.AddAPhoto,&#10;                                contentDescription = null&#10;                            )&#10;                            Spacer(modifier = Modifier.width(8.dp))&#10;                            Text(&quot;Kamera&quot;)&#10;                        }&#10;&#10;                        Button(&#10;                            onClick = {&#10;                                galleryLauncher.launch(&#10;                                    PickVisualMediaRequest(ActivityResultContracts.PickVisualMedia.ImageOnly)&#10;                                )&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.primary,&#10;                                contentColor = MaterialTheme.colorScheme.onPrimary&#10;                            )&#10;                        ) {&#10;                            Icon(&#10;                                imageVector = Icons.Default.PhotoLibrary,&#10;                                contentDescription = null&#10;                            )&#10;                            Spacer(modifier = Modifier.width(8.dp))&#10;                            Text(&quot;Galeri&quot;)&#10;                        }&#10;                    }&#10;&#10;                    if (selectedImageUri != null) {&#10;                        Spacer(modifier = Modifier.height(12.dp))&#10;                        Text(&#10;                            text = &quot;Preview Foto&quot;,&#10;                            style = MaterialTheme.typography.bodyMedium,&#10;                            fontWeight = FontWeight.Medium&#10;                        )&#10;                        Box(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(180.dp)&#10;                                .background(&#10;                                    color = MaterialTheme.colorScheme.surfaceVariant,&#10;                                    shape = RoundedCornerShape(16.dp)&#10;                                ),&#10;                            contentAlignment = Alignment.Center&#10;                        ) {&#10;                            Image(&#10;                                painter = rememberAsyncImagePainter(selectedImageUri),&#10;                                contentDescription = null,&#10;                                modifier = Modifier.fillMaxSize(),&#10;                                contentScale = ContentScale.Crop&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;                    ) {&#10;                        Button(&#10;                            onClick = {&#10;                                val result = onFinish(selectedImageUri)&#10;                                result?.let {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&#10;                                            message = &quot;Durasi: ${&quot;%.1f&quot;.format(it.durationMinutes)} menit 路 ${it.calories.toInt()} kcal&quot;&#10;                                        )&#10;                                    }&#10;                                }&#10;                                onBack()&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.primary,&#10;                                contentColor = MaterialTheme.colorScheme.onPrimary&#10;                            )&#10;                        ) {&#10;                            Text(&quot;Simpan &amp; Kembali&quot;)&#10;                        }&#10;&#10;                        Button(&#10;                            onClick = {&#10;                                val result = onFinish(null)&#10;                                result?.let {&#10;                                    scope.launch {&#10;                                        snackbarHostState.showSnackbar(&#10;                                            message = &quot;Durasi: ${&quot;%.1f&quot;.format(it.durationMinutes)} menit 路 ${it.calories.toInt()} kcal&quot;&#10;                                        )&#10;                                    }&#10;                                }&#10;                                onBack()&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.secondary,&#10;                                contentColor = MaterialTheme.colorScheme.onSecondary&#10;                            )&#10;                        ) {&#10;                            Text(&quot;Lewati Foto&quot;)&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    if (showFinishDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showFinishDialog = false },&#10;            icon = {&#10;                Icon(&#10;                    imageVector = Icons.Default.Bolt,&#10;                    contentDescription = null,&#10;                    tint = MaterialTheme.colorScheme.primary&#10;                )&#10;            },&#10;            title = { Text(text = &quot;Selesaikan sesi?&quot;) },&#10;            text = { Text(text = &quot;Pastikan kamu sudah menyelesaikan workout ini.&quot;) },&#10;            confirmButton = {&#10;                TextButton(onClick = finishSession) {&#10;                    Text(text = &quot;Ya, selesai&quot;)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { showFinishDialog = false }) {&#10;                    Text(text = &quot;Batal&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ControlButtons(&#10;    isRunning: Boolean,&#10;    isPaused: Boolean,&#10;    onStart: () -&gt; Unit,&#10;    onPause: () -&gt; Unit,&#10;    onResume: () -&gt; Unit,&#10;    onFinish: () -&gt; Unit&#10;) {&#10;    Column(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        verticalArrangement = Arrangement.spacedBy(14.dp)&#10;    ) {&#10;        Button(&#10;            onClick = { if (isPaused) onResume() else onStart() },&#10;            enabled = !isRunning,&#10;            colors = ButtonDefaults.buttonColors(&#10;                containerColor = MaterialTheme.colorScheme.primary,&#10;                contentColor = MaterialTheme.colorScheme.onPrimary&#10;            ),&#10;            shape = RoundedCornerShape(14.dp),&#10;            modifier = Modifier.fillMaxWidth()&#10;        ) {&#10;            Text(if (isPaused) &quot;Resume&quot; else &quot;Mulai Sekarang&quot;, fontWeight = FontWeight.SemiBold)&#10;        }&#10;&#10;        Row(&#10;            modifier = Modifier.fillMaxWidth(),&#10;            horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;        ) {&#10;            Button(&#10;                onClick = onPause,&#10;                enabled = isRunning,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = MaterialTheme.colorScheme.secondary,&#10;                    contentColor = MaterialTheme.colorScheme.onSecondary&#10;                ),&#10;                shape = RoundedCornerShape(14.dp),&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&quot;Pause&quot;, fontWeight = FontWeight.SemiBold)&#10;            }&#10;&#10;            Button(&#10;                onClick = onFinish,&#10;                enabled = isRunning || isPaused,&#10;                colors = ButtonDefaults.buttonColors(&#10;                    containerColor = MaterialTheme.colorScheme.tertiary,&#10;                    contentColor = MaterialTheme.colorScheme.onTertiary&#10;                ),&#10;                shape = RoundedCornerShape(14.dp),&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&quot;Selesai&quot;, fontWeight = FontWeight.SemiBold)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun TimerDisplay(workout: Workout?, timerState: WorkoutViewModel.TimerState) {&#10;    Column(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        horizontalAlignment = Alignment.CenterHorizontally,&#10;        verticalArrangement = Arrangement.spacedBy(16.dp)&#10;    ) {&#10;        Box(&#10;            modifier = Modifier&#10;                .size(260.dp)&#10;                .shadow(24.dp, CircleShape)&#10;                .border(&#10;                    width = 2.dp,&#10;                    brush = Brush.linearGradient(&#10;                        colors = listOf(&#10;                            MaterialTheme.colorScheme.primary,&#10;                            MaterialTheme.colorScheme.secondary&#10;                        )&#10;                    ),&#10;                    shape = CircleShape&#10;                )&#10;                .background(MaterialTheme.colorScheme.surfaceVariant, CircleShape)&#10;                .padding(28.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Column(&#10;                horizontalAlignment = Alignment.CenterHorizontally,&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(72.dp)&#10;                        .background(MaterialTheme.colorScheme.background, CircleShape),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Bolt,&#10;                        contentDescription = null,&#10;                        tint = MaterialTheme.colorScheme.primary,&#10;                        modifier = Modifier.size(36.dp)&#10;                    )&#10;                }&#10;&#10;                Text(&#10;                    text = formatTime(timerState.elapsedSeconds),&#10;                    style = MaterialTheme.typography.displayMedium,&#10;                    fontWeight = FontWeight.ExtraBold&#10;                )&#10;                Text(&#10;                    text = when {&#10;                        timerState.isRunning -&gt; &quot;Tracking in progress&quot;&#10;                        timerState.isPaused -&gt; &quot;Paused, ready to resume&quot;&#10;                        else -&gt; &quot;Siap mulai sesi&quot;&#10;                    },&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;        }&#10;&#10;        Column(&#10;            horizontalAlignment = Alignment.CenterHorizontally,&#10;            verticalArrangement = Arrangement.spacedBy(6.dp)&#10;        ) {&#10;            Text(&#10;                text = workout?.name ?: &quot;&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                fontWeight = FontWeight.Bold&#10;            )&#10;            Row(horizontalArrangement = Arrangement.spacedBy(12.dp)) {&#10;                StatusPill(text = &quot;MET ${workout?.met ?: &quot;-&quot;}&quot;)&#10;                StatusPill(text = if (timerState.isRunning) &quot;Live&quot; else &quot;Idle&quot;)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun StatusPill(text: String) {&#10;    Box(&#10;        modifier = Modifier&#10;            .background(&#10;                MaterialTheme.colorScheme.background,&#10;                shape = RoundedCornerShape(12.dp)&#10;            )&#10;            .border(&#10;                width = 1.dp,&#10;                brush = Brush.linearGradient(&#10;                    listOf(&#10;                        MaterialTheme.colorScheme.primary,&#10;                        MaterialTheme.colorScheme.secondary&#10;                    )&#10;                ),&#10;                shape = RoundedCornerShape(12.dp)&#10;            )&#10;            .padding(horizontal = 12.dp, vertical = 6.dp)&#10;    ) {&#10;        Text(&#10;            text = text,&#10;            style = MaterialTheme.typography.bodySmall,&#10;            color = MaterialTheme.colorScheme.onSurface&#10;        )&#10;    }&#10;}&#10;&#10;private fun formatTime(seconds: Int): String {&#10;    val minutes = seconds / 60&#10;    val remainingSeconds = seconds % 60&#10;    return String.format(&quot;%02d:%02d&quot;, minutes, remainingSeconds)&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/xml/file_paths.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/xml/file_paths.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;paths xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;&#10;    &lt;cache-path name=&quot;workout_images&quot; path=&quot;/&quot; /&gt;&#10;&lt;/paths&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>